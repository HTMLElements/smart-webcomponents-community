
/* Smart HTML Elements v1.0.0 (2018-April) 
Copyright (c) 2011-2018 jQWidgets. 
License: http://htmlelements.com/pricing/ */

 "use strict";Smart.Utilities.Assign("Draw",function(){function t(e){babelHelpers.classCallCheck(this,t);var r=this;r.host=e,r.renderEngine="",r.refresh();var i=["clear","removeElement","attr","getAttr","line","circle","rect","path","pieslice","pieSlicePath","text","measureText"];for(var a in i)r._addFn(Smart.Utilities.Draw.prototype,i[a])}return babelHelpers.createClass(t,[{key:"_addFn",value:function(t,e){t[e]||(t[e]=function(){return this.renderer[e].apply(this.renderer,arguments)})}},{key:"_initRenderer",value:function(t){return this.createRenderer(this,t)}},{key:"_internalRefresh",value:function(){var t=this;if("none"!==window.getComputedStyle(t.host).display){t.renderer||(t.host.innerHTML="",t._initRenderer(t.host));var e=t.renderer;if(e){var r=e.getRect();t._render({x:1,y:1,width:r.width,height:r.height})}}}},{key:"_render",value:function(t){this._plotRect=t}},{key:"refresh",value:function(){this._internalRefresh()}},{key:"getSize",value:function(){var t=this._plotRect;return{width:t.width,height:t.height}}},{key:"toGreyScale",value:function(t){if(-1===t.indexOf("#"))return t;var e=this.cssToRgb(t);e[0]=e[1]=e[2]=Math.round(.3*e[0]+.59*e[1]+.11*e[2]);var r=this.rgbToHex(e[0],e[1],e[2]);return"#"+r[0]+r[1]+r[2]}},{key:"decToHex",value:function(t){return t.toString(16)}},{key:"hexToDec",value:function(t){return parseInt(t,16)}},{key:"rgbToHex",value:function(t,e,r){return[this.decToHex(t),this.decToHex(e),this.decToHex(r)]}},{key:"hexToRgb",value:function(t,e,r){return[this.hexToDec(t),this.hexToDec(e),this.hexToDec(r)]}},{key:"cssToRgb",value:function(t){return t.indexOf("rgb")<=-1?this.hexToRgb(t.substring(1,3),t.substring(3,5),t.substring(5,7)):t.substring(4,t.length-1).split(",")}},{key:"hslToRgb",value:function(t){var e=void 0,r=void 0,i=void 0,a=parseFloat(t[0]),n=parseFloat(t[1]),h=parseFloat(t[2]);if(0===n)e=r=i=h;else{var s=h<.5?h*(1+n):h+n-h*n,o=2*h-s;e=this.hueToRgb(o,s,a+1/3),r=this.hueToRgb(o,s,a),i=this.hueToRgb(o,s,a-1/3)}return[255*e,255*r,255*i]}},{key:"hueToRgb",value:function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}},{key:"rgbToHsl",value:function(t){var e=parseFloat(t[0])/255,r=parseFloat(t[1])/255,i=parseFloat(t[2])/255,a=Math.max(e,r,i),n=Math.min(e,r,i),h=void 0,s=void 0,o=(a+n)/2;if(a===n)h=s=0;else{var u=a-n;switch(s=o>.5?u/(2-a-n):u/(a+n),a){case e:h=(r-i)/u+(r<i?6:0);break;case r:h=(i-e)/u+2;break;case i:h=(e-r)/u+4}h/=6}return[h,s,o]}},{key:"swap",value:function(t,e){var r=t;t=e,e=r}},{key:"getNum",value:function(t){if(t.constructor!==Array){if(isNaN(t))return 0}else for(var e=0;e<t.length;e++)if(!isNaN(t[e]))return t[e];return 0}},{key:"_ptdist",value:function(t,e,r,i){return Math.sqrt((r-t)*(r-t)+(i-e)*(i-e))}},{key:"_ptRotate",value:function(t,e,r,i,a){var n=Math.sqrt(Math.pow(Math.abs(t-r),2)+Math.pow(Math.abs(e-i),2)),h=Math.asin((t-r)/n),s=h+a;return t=r+Math.cos(s)*n,e=i+Math.sin(s)*n,{x:t,y:e}}},{key:"log",value:function(t,e){return Math.log(t)/(e?Math.log(e):1)}},{key:"_mod",value:function(t,e){var r=Math.abs(t>e?e:t),i=1;if(0!==r)for(;r*i<100;)i*=10;return t*=i,e*=i,t%e/i}},{key:"ptrnd",value:function(t){if(.5===Math.abs(Math.round(t)-t))return t;var e=Math.round(t);return e<t&&(e-=1),e+.5}},{key:"createRenderer",value:function(t,e){var r=t,i=r.renderer=null;return document.createElementNS&&(i=new Smart.Utilities.SvgRenderer,i.init(e)),r.renderer=i,i}},{key:"getByPriority",value:function(t){for(var e=void 0,r=0;r<t.length&&void 0===e;r++)void 0===e&&void 0!==t[r]&&(e=t[r]);return e}},{key:"get",value:function(t,e,r){return void 0!==r?t[e][r]:t[e]}},{key:"min",value:function(t,e){for(var r=NaN,i=0;i<t.length;i++){var a=this.get(t,i,e);(isNaN(r)||a<r)&&(r=a)}return r}},{key:"max",value:function(t,e){for(var r=NaN,i=0;i<t.length;i++){var a=this.get(t,i,e);(isNaN(r)||a>r)&&(r=a)}return r}},{key:"sum",value:function(t,e){for(var r=0,i=0;i<t.length;i++){var a=this.get(t,i,e);isNaN(a)||(r+=a)}return r}},{key:"count",value:function(t,e){for(var r=0,i=0;i<t.length;i++){var a=this.get(t,i,e);isNaN(a)||r++}return r}},{key:"avg",value:function(t,e){return this.sum(t,e)/Math.max(1,this.count(t,e))}},{key:"filter",value:function(t,e){if(!e)return t;for(var r=[],i=0;i<t.length;i++)e(t[i])&&r.push(t[i]);return r}},{key:"scale",value:function(t,e,r,i){if(isNaN(t))return NaN;if((t<Math.min(e.min,e.max)||t>Math.max(e.min,e.max))&&(!i||!0!==i.ignore_range))return NaN;var a=NaN,n=1;if(void 0===e.type||"logarithmic"!==e.type){var h=Math.abs(e.max-e.min);h||(h=1),n=Math.abs(t-Math.min(e.min,e.max))/h}else if("logarithmic"===e.type){var s=e.base;isNaN(s)&&(s=10);var o=Math.min(e.min,e.max);o<=0&&(o=1);var u=Math.max(e.min,e.max);u<=0&&(u=1);var l=this.log(u,s);u=Math.pow(s,l);var d=this.log(o,s);o=Math.pow(s,d);var c=this.log(t,s);n=Math.abs(c-d)/(l-d)}if("logarithmic"===r.type){var v=r.base;isNaN(v)&&(v=10);var f=this.log(r.max,v),p=this.log(r.min,v);r.flip&&(n=1-n);var g=Math.min(p,f)+n*Math.abs(f-p);a=Math.pow(v,g)}else a=Math.min(r.min,r.max)+n*Math.abs(r.max-r.min),r.flip&&(a=Math.max(r.min,r.max)-a+r.min);return a}},{key:"axis",value:function(t,e,r){if(r<=1)return[e,t];(isNaN(r)||r<2)&&(r=2);for(var i=0;Math.round(t)!==t&&Math.round(e)!==e&&i<10;)t*=10,e*=10,i++;for(var a=(e-t)/r;i<10&&Math.round(a)!==a;)t*=10,e*=10,a*=10,i++;for(var n=[1,2,5],h=0,s=void 0;;){var o=h%n.length,u=Math.floor(h/n.length),l=Math.pow(10,u)*n[o];if(o=(h+1)%n.length,u=Math.floor((h+1)/n.length),s=Math.pow(10,u)*n[o],a>=l&&a<s)break;h++}for(var d=s,c=[],v=this.renderer._rnd(t,d,!1),f=i<=0?1:Math.pow(10,i);v<e+d;)c.push(v/f),v+=d;return c}}]),t}()),Smart.Utilities.Assign("SvgRenderer",function(){function t(){babelHelpers.classCallCheck(this,t);var e=this;e._svgns="http://www.w3.org/2000/svg",e._openGroups=[],e._clipId=0,e._gradients={},e._toRadiansCoefficient=2*Math.PI/360}return babelHelpers.createClass(t,[{key:"init",value:function(t){var e=document.createElement("div");e.className="drawContainer",e.onselectstart=function(){return!1},t.appendChild(e),this.host=t,this.container=e;try{var r=document.createElementNS(this._svgns,"svg");r.setAttribute("version","1.1"),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("overflow","hidden"),e.appendChild(r),this.canvas=r}catch(t){return!1}return this._id=(new Date).getTime(),this.clear(),!0}},{key:"getType",value:function(){return"SVG"}},{key:"refresh",value:function(){}},{key:"_rup",value:function(t){var e=Math.round(t);return t>e&&e++,e}},{key:"getRect",value:function(){return{x:0,y:0,width:Math.max(this._rup(this.host.offsetWidth)-1,0),height:Math.max(this._rup(this.host.offsetHeight)-1,0)}}},{key:"getContainer",value:function(){return this.container}},{key:"clear",value:function(){for(;this.canvas.childNodes.length>0;)this.removeElement(this.canvas.firstElementChild);this._defaultParent=void 0,this._defs=document.createElementNS(this._svgns,"defs"),this._gradients={},this.canvas.appendChild(this._defs)}},{key:"removeElement",value:function(t){if(void 0!==t)try{for(;t.firstChild;)this.removeElement(t.firstChild);t.parentNode?t.parentNode.removeChild(t):this.canvas.removeChild(t)}catch(t){}}},{key:"beginGroup",value:function(){var t=this._activeParent(),e=document.createElementNS(this._svgns,"g");return t.appendChild(e),this._openGroups.push(e),e}},{key:"endGroup",value:function(){0!==this._openGroups.length&&this._openGroups.pop()}},{key:"_activeParent",value:function(){return 0===this._openGroups.length?this.canvas:this._openGroups[this._openGroups.length-1]}},{key:"createClipRect",value:function(t){var e=document.createElementNS(this._svgns,"clipPath"),r=document.createElementNS(this._svgns,"rect");return this.attr(r,{x:t.x,y:t.y,width:t.width,height:t.height,fill:"none"}),this._clipId=this._clipId||0,e.id="cl"+this._id+"_"+(++this._clipId).toString(),e.appendChild(r),this._defs.appendChild(e),e}},{key:"getWindowHref",value:function(){var t=window.location.href;return t?(t=t.replace(/([\('\)])/g,"\\$1"),t=t.replace(/#.*$/,"")):t}},{key:"setClip",value:function(t,e){var r="url("+this.getWindowHref()+"#"+e.id+")";return this.attr(t,{"clip-path":r})}},{key:"shape",value:function(t,e){var r=document.createElementNS(this._svgns,t);if(r){for(var i in e)r.setAttribute(i,e[i]);return this._activeParent().appendChild(r),r}}},{key:"_getTextParts",value:function(t,e,r){var i={width:0,height:0,parts:[]};if(void 0===t)return i;var a=t.toString().split("<br>"),n=this._activeParent(),h=document.createElementNS(this._svgns,"text");this.attr(h,r);for(var s=0;s<a.length;s++){var o=a[s],u=h.ownerDocument.createTextNode(o);h.appendChild(u),n.appendChild(h);var l=void 0;try{l=h.getBBox()}catch(t){}var d=this._rup(l.width),c=this._rup(.6*l.height);h.removeChild(u),i.width=Math.max(i.width,d),i.height+=c+(s>0?4:0),i.parts.push({width:d,height:c,text:o})}return n.removeChild(h),i}},{key:"measureText",value:function(t,e,r,i){var a=this._getTextParts(t,e,r),n=a.width,h=a.height;!1===i&&(h/=.6);var s={};if(isNaN(e)&&(e=0),0===e)s={width:this._rup(n),height:this._rup(h)};else{var o=e*Math.PI*2/360,u=Math.abs(Math.sin(o)),l=Math.abs(Math.cos(o)),d=Math.abs(n*u+h*l),c=Math.abs(n*l+h*u);s={width:this._rup(c),height:this._rup(d)}}return i&&(s.textPartsInfo=a),s}},{key:"alignTextInRect",value:function(t,e,r,i,a,n,h,s,o,u){var l=o*Math.PI*2/360,d=Math.sin(l),c=Math.cos(l),v=a*d,f=a*c;"center"===h||""===h||"undefined"===h?t+=r/2:"right"===h&&(t+=r),"center"===s||"middle"===s||""===s||"undefined"===s?e+=i/2:"bottom"===s?e+=i-n/2:"top"===s&&(e+=n/2),u=u||"";var p="middle";-1!==u.indexOf("top")?p="top":-1!==u.indexOf("bottom")&&(p="bottom");var g="center";return-1!==u.indexOf("left")?g="left":-1!==u.indexOf("right")&&(g="right"),"center"===g?(t-=f/2,e-=v/2):"right"===g&&(t-=f,e-=v),"top"===p?(t-=n*d,e+=n*c):"middle"===p&&(t-=n*d/2,e+=n*c/2),t=this._rup(t),e=this._rup(e),{x:t,y:e}}},{key:"text",value:function(t,e,r,i,a,n,h,s,o,u,l){var d=this.measureText(t,n,h,!0,this),c=d.textPartsInfo,v=c.parts,f=void 0;if(o||(o="center"),u||(u="center"),(v.length>1||s)&&(f=this.beginGroup()),s){var p=this.createClipRect({x:this._rup(e)-1,y:this._rup(r)-1,width:this._rup(i)+2,height:this._rup(a)+2});this.setClip(f,p)}var g=this._activeParent(),m=0,y=0;m=c.width,y=c.height,(isNaN(i)||i<=0)&&(i=m),(isNaN(a)||a<=0)&&(a=y);var _=i||0,x=a||0,M=0;if(!n||0===n){r+=y,"center"===u||"middle"===u?r+=(x-y)/2:"bottom"===u&&(r+=x-y),i||(i=m),a||(a=y),g=this._activeParent();for(var k=void 0,b=v.length-1;b>=0;b--){k=document.createElementNS(this._svgns,"text"),this.attr(k,h),this.attr(k,{cursor:"default"});var N=k.ownerDocument.createTextNode(v[b].text);k.appendChild(N);var w=e,C=v[b].width,T=v[b].height;"center"===o?w+=(_-C)/2:"right"===o&&(w+=_-C),this.attr(k,{x:this._rup(w),y:this._rup(r+M),width:this._rup(C),height:this._rup(T)}),g.appendChild(k),M-=v[b].height+4}return f?(this.endGroup(),f):k}var R=this.alignTextInRect(e,r,i,a,m,y,o,u,n,l);e=R.x,r=R.y;var S=this.shape("g",{transform:"translate("+e+","+r+")"}),E=this.shape("g",{transform:"rotate("+n+")"});S.appendChild(E),M=0;for(var H=v.length-1;H>=0;H--){var P=document.createElementNS(this._svgns,"text");this.attr(P,h),this.attr(P,{cursor:"default"});var G=P.ownerDocument.createTextNode(v[H].text);P.appendChild(G);var A=0,I=v[H].width,D=v[H].height;"center"===o?A+=(c.width-I)/2:"right"===o&&(A+=c.width-I),this.attr(P,{x:this._rup(A),y:this._rup(M),width:this._rup(I),height:this._rup(D)}),E.appendChild(P),M-=D+4}return g.appendChild(S),f&&this.endGroup(),S}},{key:"line",value:function(t,e,r,i,a){var n=this.shape("line",{x1:t,y1:e,x2:r,y2:i});return this.attr(n,a),n}},{key:"path",value:function(t,e){var r=this.shape("path");return r.setAttribute("d",t),e&&this.attr(r,e),r}},{key:"_rnd",value:function(t,e,r,i){if(isNaN(t))return t;void 0===i&&(i=!0);var a=t-(!0===i?t%e:this._mod(t,e));return t===a?a:(r?t>a&&(a+=e):a>t&&(a-=e),1===e?Math.round(a):a)}},{key:"_ptrnd",value:function(t){if(!document.createElementNS)return Math.round(t)===t?t:this._rnd(t,1,!1,!0);var e=this._rnd(t,.5,!1,!0);return.5!==Math.abs(e-Math.round(e))?e>t?e-.5:e+.5:e}},{key:"rect",value:function(t,e,r,i,a){t=this._ptrnd(t),e=this._ptrnd(e),r=Math.max(1,this._rnd(r,1,!1)),i=Math.max(1,this._rnd(i,1,!1));var n=this.shape("rect",{x:t,y:e,width:r,height:i});return a&&this.attr(n,a),n}},{key:"circle",value:function(t,e,r,i){var a=this.shape("circle",{cx:t,cy:e,r:r});return i&&this.attr(a,i),a}},{key:"pieSlicePath",value:function(t,e,r,i,a,n,h){i||(i=1);var s=Math.abs(a-n),o=s>180?1:0;s>=360&&(n=a+359.99);var u=a*this._toRadiansCoefficient,l=n*this._toRadiansCoefficient,d=t,c=t,v=e,f=e,p=!isNaN(r)&&r>0;p&&(h=0);var g=Math.cos(u),m=Math.sin(u),y=Math.cos(l),_=Math.sin(l);if(h+r>0){if(h>0){var x=s/2+a,M=x*this._toRadiansCoefficient;t+=h*Math.cos(M),e-=h*Math.sin(M)}p&&(d=t+r*g,v=e-r*m,c=t+r*y,f=e-r*_)}var k=t+i*g,b=t+i*y,N=e-i*m,w=e-i*_,C="",T=Math.abs(Math.abs(n-a)-360)>.02;return p?(C="M "+c+","+f,C+=" a"+r+","+r,C+=" 0 "+o+",1 "+(d-c)+","+(v-f),C+=T?" L"+k+","+N:" M"+k+","+N,C+=" a"+i+","+i,C+=" 0 "+o+",0 "+(b-k)+","+(w-N),T&&(C+=" Z")):(C="M "+b+","+w,C+=" a"+i+","+i,C+=" 0 "+o+",1 "+(k-b)+","+(N-w),T&&(C+=" L"+t+","+e,C+=" Z")),C}},{key:"pieslice",value:function(t,e,r,i,a,n,h,s){var o=this.pieSlicePath(t,e,r,i,a,n,h),u=this.shape("path");return u.setAttribute("d",o),s&&this.attr(u,s),u}},{key:"attr",value:function(t,e){if(t&&e)for(var r in e)"textContent"===r?t.textContent=e[r]:t.setAttribute(r,e[r])}},{key:"removeAttr",value:function(t,e){if(t&&e)for(var r in e)"textContent"===r?t.textContent="":t.removeAttribute(e[r])}},{key:"getAttr",value:function(t,e){return t.getAttribute(e)}},{key:"adjustColor",value:function(t,e){if("string"!=typeof t)return"#000000";if(-1===t.indexOf("#"))return t;var r=this.cssToRgb(t),i=this.rgbToHsl(r);i[2]=Math.min(1,i[2]*e),i[1]=Math.min(1,i[1]*e*1.1),r=this.hslToRgb(i),t="#";for(var a=0;a<3;a++){var n=Math.round(r[a]);n=this.decToHex(n),1===n.toString().length&&(t+="0"),t+=n}return t.toUpperCase()}},{key:"_toLinearGradient",value:function(t,e,r){var i="grd"+this._id+t.replace("#","")+(e?"v":"h"),a="url("+this.getWindowHref()+"#"+i+")";if(this._gradients[a])return a;var n=document.createElementNS(this._svgns,"linearGradient");this.attr(n,{x1:"0%",y1:"0%",x2:e?"0%":"100%",y2:e?"100%":"0%",id:i});for(var h=0;h<r.length;h++){var s=r[h],o=document.createElementNS(this._svgns,"stop"),u="stop-color:"+this.adjustColor(t,s[1]);this.attr(o,{offset:s[0]+"%",style:u}),n.appendChild(o)}return this._defs.appendChild(n),this._gradients[a]=!0,a}},{key:"_toRadialGradient",value:function(t,e,r){var i="grd"+this._id+t.replace("#","")+"r"+(void 0!==r?r.key:""),a="url("+this.getWindowHref()+"#"+i+")";if(this._gradients[a])return a;var n=document.createElementNS(this._svgns,"radialGradient");void 0===r?this.attr(n,{cx:"50%",cy:"50%",r:"100%",fx:"50%",fy:"50%",id:i}):this.attr(n,{cx:r.x,cy:r.y,r:r.outerRadius,id:i,gradientUnits:"userSpaceOnUse"});for(var h=0;h<e.length;h++){var s=e[h],o=document.createElementNS(this._svgns,"stop"),u="stop-color:"+this.adjustColor(t,s[1]);this.attr(o,{offset:s[0]+"%",style:u}),n.appendChild(o)}return this._defs.appendChild(n),this._gradients[a]=!0,a}}]),t}());
//# sourceMappingURL=smart.draw.js.map
